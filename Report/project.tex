% Final Project

\documentclass[a4paper, 12pt, notitlepage]{report}

\usepackage{amsfonts} % if you want blackboard bold symbols e.g. for real numbers
\usepackage{graphicx} % if you want to include jpeg or pdf pictures
\usepackage{multirow}
\usepackage{array}
\usepackage{cite}
\usepackage{amssymb}
\usepackage{amsmath}

\title{\textbf{Unit Commitment Problem}\\[2em]ECE619 Project Final Report}
\author{Jiahui Guo}
\date{May.6 2013}

\begin{document}

%%%%%%%%%% PRELIMINARY MATERIAL %%%%%%%%%%
\maketitle
\begin{center}
Supervised by Dr.\ Kevin Tomsovic.
\end{center}
\thispagestyle{empty}
\newpage
\section*{Acknowledgement of Sources}
For all ideas taken from other sources (books, articles, internet), the source of the ideas is mentioned in the main text and fully referenced at the end of the report.

All material which is quoted essentially word-for-word from other sources is given in quotation marks and referenced.

Pictures and diagrams copied from the internet or other sources are labelled with a reference to the web page or book, article etc.

\tableofcontents

%%%%%%%%%% MAIN TEXT STARTS HERE %%%%%%%%%%

%%%%%%%%%% SAMPLE CHAPTER %%%%%%%%%%
\chapter{Overall Problem Definition}
%


\section{Background}
%
Unit Commitment(UC) schedules the on-and-off times of the generating units, and calculates the minimum cost hourly generation schedule while ensuring that start-up and shut-down rates, minimum up and minimum down times are considered.\\
The UC is important because it is not only a way to promote the system economy, but also for the following reasons:\cite{1}
\begin{enumerate}
\item[1)]Start-up, shut-down and the dynamic considerations in restarting the modern generating facilities are much more complex and costier than they were for smaller, older units;
\item[2)]Growth in system size to the point where even small percentage gains have becomes economically very important;
\item[3)]Increase in variation between the peak and off-peak power demands;
\item[4)]System planning requires automated computerized schedulers to simulate the effect of unit selection methods on the choice of new generation;
\item[5)]Scheduling problem has grown out of the effective reach of the "earlier" techniques because of the large variaty in efficiencies and types of power sources.
\end{enumerate}

\section{Problem Definition}
%
In current system operation center, day-ahead schedule(Unit Commitment) and real-time balancing (Optimal Power Flow) are considered separately. In day-ahead schedule, ISOs schedule the startup and shutdown state and the power output of each generator for each time interval in order to minimize the overall cost over the next $24$ hours. In real time schedule, ISOs re-adjust each generator's output to balance demand and generation. This study only focuses on day-ahead UC problem.
In this project, a single bus system with 4 generators and one aggregated load is proposed. The constraints listed as following are added at different stages in order to solve the problem from simplicity to complexity.

\section{Modeling in Unit Commitment}

\subsection{Nomenclature}
\begin{description}
\item[$k$]Index for unit.
\item[$t$]Index for hour.
\item[$N_h$]Total hour horizon scheduled.
\item[$N_g$]Number of generator units.
\item[$P_k(t)$]Amount of electricity generated by generator $k$ in time period $t$.
\item[$Fs_{k}$]Half of start-up cost plus shut down cost.
\item[$D(t)$]Forecasted system demand at time $t$.
\item[$P_{min,k}$]Lower limit of real power generation of unit $k$.
\item[$P_{max,k}$]Upper limit of real power generation of unit $k$.
\item[$R(t)$]Amount of spinning reserve at time $t$.
\item[$Z_k(t)$]Binary variable to indicate if generator $k$ is on in time period $t$.
\item[$a_k,b_k,c_k$]Quadratic energy cost coefficients of unit $k$.
\end{description}

\subsection{Modeling}
\begin{gather}
\min\sum_{t=1}^{N_h} \sum_{k=1}^{N_g}[a_{k}(t)+b_{k}P_{k}(t)+c_{k}P_{k}^2(t)+Fs_{k}(1-Z_{k}(t-1))]Z_{k}(t)\label{eqn:equ1}
\end{gather}
\textit{s.t.} \\
\begin{gather}
\sum_{k=1}^{N_g}P_{k}(t) = D(t)\label{eqn:equ4}\\
P_{min,k}(t)Z_{k}(t)\leq P_{k}(t)\leq P_{max,k}(t)Z_{k}(t) \label{eqn:equ7}\\
P_{k}(t)+R_{k}(t)-\sum_{k=1}^{N_g}P_{max,k}Z_{k}(t)\leq 0\label{eqn:equ2}\\
Z_{k}(t)\in \{0,1\}\\
\forall k = 1,2,...,N_g\\
\forall t = 1,2,...,N_h
\end{gather}

\chapter{Solving the UC Problem}
\section{Approaches}
To solve the UC problem, there are various methods, classified as classical, non-classical and hybrid model\cite{2,3}. In this project, the following methods are utilized, the differences are the number of constraints considered when solving the UC problem.
\begin{enumerate}
\item[1)]Priority List
\item[2)]Dynamic Programming
\item[3)]Dynamic Programming + Priority List
\item[4)]Particle Swarm Optimization
\end{enumerate}

\subsection{Priority List}
The priority list is created according to each unit parameters. In this project, priority list is based on fuel cost
obtained from the average fuel cost of each unit operating at its maximum output power. The average full-load cost $\alpha$
is defined as the cost per unit of power \$\/MW when the unit is at its full capacity. It can be expressed as
\begin{equation}
\alpha_{i}=\frac{f_{i}(P_{max,i})}{P_{max,i}}+b_{i}+c_{i}P_{max,i}
\end{equation}
The units are ranked by their $\alpha$ in ascending order. Thus, the priority list of units will be formulated based on the order of $\alpha_{i}$,
in which a unit with the lowest $\alpha_{i}$ will have the highest priority to be dispatched.\cite{7}

\subsection{Dynamic Programming}
For the dynamic programming, it is a methodical procedure which systematically evaluates a large number of possible decisions in a multi-step problem. The convention dynamic programming takes all the states into account, for a $N_g$ generation, $N_h$ hours UC scheduling, the total path is ($2^{N_{g}}-1)^{N_{h}}$. In this project, the forward approach is utilized, the recursive algorithm is used to compute the minimum cost in hour $t$ with feasible state $I$, i.e.
\begin{equation}
F_{t,I}=\min[F(t,I)+S_{c}(t-1,L=>t,I)+F_{tc}(t-1,I)
\end{equation}
Where $F_{tc}(t,I)$ is the cost from initial state to hour $t$ state $I$, $S_{c}(t-1,L=>t,I)$ is the transition cost from state $(t-1,L)$ to state $(t,I)$, and $F(t,I)$ is the production cost for state $(t,I)$.
\subsection{Dynamic Programming + Priority List}
Since the priority list can have to choose better feasible states, for the dynamic programming, it doesn't have to traverse all the states, but only the feasible states filtered by priority list. And this method could promote the performance of dynamic programming.\cite{5}
\subsection{Particle Swarm Optimization}
PSO algorithm exploits a population of individuals(particles) to probe promising regions of search space, and each particle moves with an adaptable velocity within the regions of decision space and retains a memory of the best position it ever encountered. The best position ever attained by each particle of the swarm is communicated to all other particles.
The PSO assumes that the swarm is manipulated by the equation:
\begin{equation}
V_{i}^{t} = \omega V_{i}^{t-1}+C_{1}\cdot rand_{1}\cdot(P_{bi}^{t-1}-X_{i}^{t-1})+ C_{2}\cdot rand_{2}\cdot(P_{gbi}^{t-1}-X_{i}^{t-1})
\end{equation}
where
\begin{itemize}
  \item $\omega$: The inertia weight
  \item $C_{1},C_{2}$: The acceleration coefficients
  \item $rand_{1},rand_{2}$: Separately generated uniformed distributed random numbers between 0 and 1
  \item $X_{i}$: The position of the particle
  \item $V_{i}$: The velocity of the $ith$ dimension
\end{itemize}
And the $X_{i}^{t}$ is updated based on the velocity, since the $X_{i}^{t}$ should be a binary, a sigmoid function is applied to the velocity to produce a threshold, as follows:
\begin{equation}
rand() < sigmoid(V_{i})~? ~1~:~0
\end{equation}
The fitness function takes the reserve into consideration, and associates a penalty with the unbalance, as shown below:
\begin{eqnarray}
fitness(P_{k}(t)) &=& \sum_{t=1}^{N_h} \{\sum_{k=1}^{N_g}[a_{k}(t)+b_{k}P_{k}(t)+c_{k}P_{k}^2(t)+Fs_{k}(1-Z_{k}(t-1))]Z_{k}(t)\nonumber\\
&+&\lambda \cdot C \cdot((D(t)+R(t)-\sum_{k=1}^{N_g}P_{max,k}Z_{k})^{2}\}
\end{eqnarray}
where
\begin{itemize}
  \item $C$: A flag which used to indicate whether the constraint is violated, if so, $C=1$, otherwise, $C=0$.
  \item $\lambda$: The penalty coefficient.
\end{itemize}
The parameters in PSO should be carefully tuned, e.g. if the inertia weight is large, it benefits global search, while it is small, it is good at local search. In this project, a self-adjust weight is used as shown in the following equation.
\begin{equation}
\omega = \omega_{max} - \frac{(\omega_{max}-\omega_{min})\cdot iter}{MaxIter}
\end{equation}
Also, the larger $C_1$ may cause the particle converge to a local optimal, while larger $C_2$ may cause the particle converge to a global optimal.
The detailed parameters are obtained from \cite{8}.

\section{Data and Parameters}
The Generation data and load data are obtained from \cite{4}, as shown in Table \ref{table:table1} and Table \ref{table:table2}.
\begin{enumerate}
\item[1)]Generation Data
\item[2)]Load Data
\end{enumerate}

\begin{table}
\centering
\begin{tabular}{ | c | c || c | c || c | c || c | c |}
\hline
Hour & P$_{load}$ & Hour & P$_{load}$  & Hour & P$_{load}$ & Hour & P$_{load}$\\
\hline
1 & 480  & 2 & 530 & 3 & 600 & 4 & 540\\
\hline
5 & 400  & 6 & 280 & 7 & 290 & 8 & 500\\
\hline
\end{tabular}
\caption{Load data}
\label{table:table1}
\end{table}

\begin{table}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
Generation. & P$_{max}$ & P$_{min}$ & Start Cost & Initial State & Coef$_{a}$ & Coef$_{b}$  &  Coef$_{c}$  \\
No.         & (MW)    & (MW)       & Cold(\$)  & at time 0     &     \$     &  \$/MWh  & \$/MWh$^{2}$ \\
\hline
1 & 80  & 25 & 350 & -5 & 970 & 17.26 & 0.0031\\
\hline
2 & 250 & 60 & 400 & 8  & 700 & 16.60 & 0.0020\\
\hline
3 & 300 & 75 & 600 & 8  & 680 & 16.50 & 0.0021\\
\hline
4 & 60  & 20 & 500 & -6 & 800 & 19.70 & 0.0039\\
\hline
\end{tabular}
\caption{Generator data}
\label{table:table2}
\end{table}

\chapter{Results}
The test system:
\begin{itemize}
  \item 4 Generation
  \item 8 hour UC scheduling.
\end{itemize}
The detailed scheduling results from these algorithms are listed in below sections, respectively.
\section{Priority List}
\input{UCPL.tex}
\clearpage
\section{Dynamic Programming}
\input{UCDPFull.tex}
\clearpage
\section{Dynamic Programming + Priority List}
\input{UCDPPL.tex}
\clearpage
\section{Particle Swarm Optimization}
For the PSO, 10 times of execution are performed to obtain the best result, which are shown in Table \ref{table:table3}.

\begin{table}
\centering
\begin{tabular}{ | c | c || c | c || c | c || c | c || c | c |}
\hline
No. & Cost$_{min}$  & No. & Cost$_{min}$  & No. & Cost$_{min}$ & No. & Cost$_{min}$ & No. & Cost$_{min}$\\
\hline
1 & 80623.92  & 2 & 77172.67 & 3 & 80296.38 & 4 & 77172.67 & 5  & 77802.07\\
\hline
6 & 77207.24  & 7 & 77172.67 & 8 & 77172.67 & 9 & 77511.09 & 10 & 77172.67\\
\hline
\end{tabular}
\caption{PSO result}
\label{table:table3}
\end{table}

Some figures showing the iteration process of the PSO fitness function are shown in Figure \ref{Figure2}-\ref{Figure4}.

\begin{figure}
\centering
\includegraphics[height=0.6\textwidth]{2.eps}
\caption{PSO fitness function iteration (1).}
\label{Figure2}
\end{figure}

\begin{figure}
\centering
\includegraphics[height=0.6\textwidth]{9.eps}
\caption{PSO fitness function iteration (1).}
\label{Figure3}
\end{figure}

\begin{figure}
\centering
\includegraphics[height=0.6\textwidth]{10.eps}
\caption{PSO fitness function iteration (3).}
\label{Figure4}
\end{figure}

\clearpage
\input{UCPSO.tex}

\clearpage
\section{The Optimization Result}
The optimization result from these methods are shown in Table \ref{table:table4}.
\begin{table}
\centering
\begin{tabular}{ | c | c | c | }
\hline
Algorithm & Cost(\$)  & Time(s)\\
\hline
PL    & 73180.39  & 0.0193\\
\hline
DP    & 73180.39  & 0.6517\\
\hline
DP+PL & 73180.39  & 0.1860\\
\hline
PSO   & 77172.67  & 343.15\\
\hline
\end{tabular}
\caption{Optimization result}
\label{table:table4}
\end{table}
\section{Observation}
\begin{itemize}
  \item The first three methods produce the same optimal solution, they all take the startup cost into consideration.
  \item Dynamic program needs more time than PL or DP+PL, since it needs to traverse more possible states.
  \item PSO considers the reserve constraint so that the optimal cost is higher than the other three.
\end{itemize}


\section{The Running Time Comparison}
The scale of the problem on time horizon is tested on $8h$, $16h$ and $24h$, it can be seen that the priority list, dynamic programming and their combination could produce almost linear runtime when the scheduling hour increase.  
\begin{figure}
\centering
\includegraphics[height=0.6\textwidth]{runtime.eps}
\caption{Running Time comparison between DP and PL.}
\label{Figure1}
\end{figure}

%%%%%%%%%% APPENDIX %%%%%%%%%%
\appendix
\chapter{Source Code}
The hierarchy of the unit commitment solution code is shown as follows:
\begin{itemize}
  \item UC.m
  \item GetData.m
  \begin{itemize}
    \item PL
    \begin{itemize}
      \item PriorityList.m
    \end{itemize}
    \item DP
    \begin{itemize}
      \item PriorityList.m
      \item FeasibleStates.m
      \item Enumerate.m
    \end{itemize}
    \item PSO
    \begin{itemize}
      \item PSO.m
      \item fitness.m
      \item sigmoid.m
    \end{itemize}
  \end{itemize}
  \item UnitTest.m
  \item ED.m
  \item PrintResult.m
\end{itemize}

\section{Unit Commitment}
\input{UC.tex}
\section{Priority List}
\input{priorityList.tex}
\section{Dynamic Programming}
\input{DP.tex}
\section{Particle Swarm Optimization}
\input{PSO.tex}
\section{Economic Dispatch}
\input{ED.tex}
\section{Get Data}
\input{GetData.tex}
\section{Generate All the States}
\input{Enumerate.tex}
\section{Find Feasible States}
\input{FeasibleStates.tex}
\section{Sigmoid Function}
\input{sigmoid.tex}
\section{Unit Test}
\input{UnitTest.tex}
\section{Print Result}
\input{PrintResult.tex}

\bibliography{IEEEabrv,bibfile}
\bibliographystyle{IEEEtran}

\end{document}
